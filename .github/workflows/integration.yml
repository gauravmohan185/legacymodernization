name: Integrated Pipeline

on:
  workflow_dispatch:
  push:
    branches: [ "java-integration" ]
    
jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4
      
      # Step 1: Install Pyhton
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.12"
          
      # Step 2: Install Pyhton Dependencies
      - name: Install Dependencies
        run: |
          python -m pip install --upgrade pip
          
      # Step 3: Checkout AST Generation code
      - name: Checkout Java Code for AST Generation
        uses: actions/checkout@v4
        with:
          uses: gopinnath/day0-cobol-extractor
          ref: refs/tags/0.1d     
      
      # Step 4: Install JDK
      - name: Set up JDK 17
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'
          cache: maven
          
      # Step 5: Install Proleap to Local repo
      - name: Install Proleap to Local Repo
        run: mvn install:install-file -Dfile=lib/proleap-cobol-parser-4.0.0.jar
        
      # Step 6: Install Proleap to Local repo
      - name: Build Application
        run: mvn install
